(()=>{var e={665:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t={};for(let e=0;e<26;e++)t[String.fromCharCode(65+e)]=e;for(let e=2;e<=7;e++)t[e.toString()]=e-2+26;const r=e.toUpperCase().trimEnd().replace(/0/g,"O").replace(/1/g,"I").replace(/ /g,"");if(/[^A-Z2-7]/.test(r))throw new Error("Invalid Base32 encoded string");const o=r.split(""),n=o.length;let a="";for(let e=0;e<n;e++)a+=t[o[e]].toString(2).padStart(5,"0");const c=Math.floor(a.length/8),i=new Uint8Array(c);for(let e=0;e<c;e++)i[e]=parseInt(a.substr(8*e,8),2);return Buffer.from(i)}},469:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"];t.default=function(e){return(e.split("").map((e=>e.charCodeAt(0).toString(2).padStart(8,"0"))).join("").match(/.{1,5}/g)||[]).map((e=>r[parseInt(e.padEnd(5,"0"),2)])).join("")}},363:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.encode=t.decode=void 0;const n=o(r(665));t.decode=n.default;const a=o(r(469));t.encode=a.default},288:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.generateSecret=function(){return(0,c.encode)(i.randomBytes(15).toString("binary"))},t.decodeSecret=function(e){return(0,c.decode)(e)},t.generateCode=u,t.generateQRCodeURI=function(e,t,r){return`otpauth://totp/${r}?secret=${e}&issuer=${t}`},t.validateUserCode=function(e,t,r,o){const n=t.replace(/ /g,"").replace(".","").replace("-","").replace(",",""),a=Math.floor(Date.now()/1e3);for(let t=-o;t<=o;t++)if(u(e,Math.floor(a/r)+t,!0)===n)return!0;return!1};const c=r(363),i=a(r(357));function u(e,t,r){const o=(0,c.decode)(e);if(!r){const e=Math.floor(Date.now()/1e3);t=Math.floor(e/t)}const n=Buffer.alloc(8);for(let e=0;e<8;e++)n[7-e]=255&t,t>>=8;const a=i.createHmac("sha1",Buffer.from(o));a.update(n);const u=a.digest(),s=15&u[u.length-1];return(((127&u[s])<<24|(255&u[s+1])<<16|(255&u[s+2])<<8|255&u[s+3])%1e6).toString().padStart(6,"0")}},357:()=>{}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,r),a.exports}(()=>{"use strict";r(288)})()})();