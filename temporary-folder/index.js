!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var o in r)("object"==typeof exports?exports:e)[o]=r[o]}}(this,(()=>(()=>{var e={665:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t={};for(let e=0;e<26;e++)t[String.fromCharCode(65+e)]=e;for(let e=2;e<=7;e++)t[e.toString()]=e-2+26;const r=e.toUpperCase().trimEnd().replace(/0/g,"O").replace(/1/g,"I").replace(/ /g,"");if(/[^A-Z2-7]/.test(r))throw new Error("Invalid Base32 encoded string");const o=r.split(""),n=o.length;let i="";for(let e=0;e<n;e++)i+=t[o[e]].toString(2).padStart(5,"0");const a=Math.floor(i.length/8),c=new Uint8Array(a);for(let e=0;e<a;e++)c[e]=parseInt(i.substr(8*e,8),2);return Buffer.from(c)}},469:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"];t.default=function(e){return(e.split("").map((e=>e.charCodeAt(0).toString(2).padStart(8,"0"))).join("").match(/.{1,5}/g)||[]).map((e=>r[parseInt(e.padEnd(5,"0"),2)])).join("")}},363:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.encode=t.decode=void 0;const n=o(r(665));t.decode=n.default;const i=o(r(469));t.encode=i.default},288:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.generateSecret=function(){return(0,a.encode)(c.randomBytes(15).toString("binary"))},t.decodeSecret=function(e){return(0,a.decode)(e)},t.generateCode=d,t.generateQRCodeURI=function(e,t,r){return`otpauth://totp/${r}?secret=${e}&issuer=${t}`},t.validateUserCode=function(e,t,r,o){const n=t.replace(/ /g,"").replace(".","").replace("-","").replace(",",""),i=Math.floor(Date.now()/1e3);for(let t=-o;t<=o;t++)if(d(e,Math.floor(i/r)+t,!0)===n)return!0;return!1};const a=r(363),c=i(r(357));function d(e,t,r){const o=(0,a.decode)(e);if(!r){const e=Math.floor(Date.now()/1e3);t=Math.floor(e/t)}const n=Buffer.alloc(8);for(let e=0;e<8;e++)n[7-e]=255&t,t>>=8;const i=c.createHmac("sha1",Buffer.from(o));i.update(n);const d=i.digest(),s=15&d[d.length-1];return(((127&d[s])<<24|(255&d[s+1])<<16|(255&d[s+2])<<8|255&d[s+3])%1e6).toString().padStart(6,"0")}},357:()=>{}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,r),i.exports}var o={};return(()=>{"use strict";var e=o;Object.defineProperty(e,"__esModule",{value:!0});const t=r(288);e.default=class{timeStep;window;generateSecret;decodeSecret;generateCode;generateQRCodeURI;validateUserCode;constructor({TOTP:{timeStep:e=30,window:r=30}}){this.timeStep=e,this.window=r,this.generateSecret=()=>(0,t.generateSecret)(),this.decodeSecret=e=>(0,t.decodeSecret)(e),this.generateCode=e=>(0,t.generateCode)(e,this.timeStep,!1),this.generateQRCodeURI=(e,r,o)=>(0,t.generateQRCodeURI)(e,r,o),this.validateUserCode=(e,r)=>(0,t.validateUserCode)(e,r,this.timeStep,this.window)}}})(),o})()));