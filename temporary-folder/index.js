!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var o in r)("object"==typeof exports?exports:e)[o]=r[o]}}(this,(()=>(()=>{var e={665:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t={};for(let e=0;e<26;e++)t[String.fromCharCode(65+e)]=e;for(let e=2;e<=7;e++)t[e.toString()]=e-2+26;const r=e.toUpperCase().trimEnd().replace(/0/g,"O").replace(/1/g,"I").replace(/ /g,"");if(/[^A-Z2-7]/.test(r))throw new Error("Invalid Base32 encoded string");const o=r.split(""),n=o.length;let a="";for(let e=0;e<n;e++)a+=t[o[e]].toString(2).padStart(5,"0");const d=Math.floor(a.length/8),i=new Uint8Array(d);for(let e=0;e<d;e++)i[e]=parseInt(a.substr(8*e,8),2);return Buffer.from(i)}},469:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"];t.default=function(e){return(e.split("").map((e=>e.charCodeAt(0).toString(2).padStart(8,"0"))).join("").match(/.{1,5}/g)||[]).map((e=>r[parseInt(e.padEnd(5,"0"),2)])).join("")}},363:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.encode=t.decode=void 0;const n=o(r(665));t.decode=n.default;const a=o(r(469));t.encode=a.default},288:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateSecret=function(){if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){const e=new Uint8Array(15);return window.crypto.getRandomValues(e),(0,n.encode)(String.fromCharCode.apply(null,Array.from(e)))}return(0,n.encode)((0,o.randomBytes)(15).toString("binary"))},t.decodeSecret=function(e){return(0,n.decode)(e)},t.generateCode=a,t.generateQRCodeURI=function(e,t,r){return`otpauth://totp/${r}?secret=${e}&issuer=${t}`},t.validateUserCode=function(e,t,r,o){const n=t.replace(/ /g,"").replace(".","").replace("-","").replace(",",""),d=Math.floor(Date.now()/1e3);for(let t=-o;t<=o;t++)if(a(e,Math.floor(d/r)+t,!0)===n)return!0;return!1};const o=r(357),n=r(363);function a(e,t,r){const a=(0,n.decode)(e);if(!r){const e=Math.floor(Date.now()/1e3);t=Math.floor(e/t)}const d=Buffer.alloc(8);for(let e=0;e<8;e++)d[7-e]=255&t,t>>=8;const i=(0,o.createHmac)("sha1",Buffer.from(a));i.update(d);const c=i.digest(),s=15&c[c.length-1];return(((127&c[s])<<24|(255&c[s+1])<<16|(255&c[s+2])<<8|255&c[s+3])%1e6).toString().padStart(6,"0")}},357:()=>{}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,r),a.exports}var o={};return(()=>{"use strict";var e=o;Object.defineProperty(e,"__esModule",{value:!0});const t=r(288);e.default=class{timeStep;window;generateSecret;decodeSecret;generateCode;generateQRCodeURI;validateUserCode;constructor({TOTP:{timeStep:e=30,window:r=30}}){this.timeStep=e,this.window=r,this.generateSecret=()=>(0,t.generateSecret)(),this.decodeSecret=e=>(0,t.decodeSecret)(e),this.generateCode=e=>(0,t.generateCode)(e,this.timeStep,!1),this.generateQRCodeURI=(e,r,o)=>(0,t.generateQRCodeURI)(e,r,o),this.validateUserCode=(e,r)=>(0,t.validateUserCode)(e,r,this.timeStep,this.window)}}})(),o})()));